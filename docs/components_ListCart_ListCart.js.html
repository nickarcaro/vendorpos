<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/ListCart/ListCart.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/ListCart/ListCart.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useContext } from "react";
import { List, Divider, Row, Col } from "antd";
import { CartContext } from "../../context/CartContext";

/**
 * Limpia el carrito
 * @function
 * @param {function} setCart funcion setter de carrito
 */
export const clearCart = (setCart) => {
  console.log("clearCart.. ");
  let cleanCart = {
    productList: [],
    promotionList: [],
    idsNotInPromotion: [],
    total: 0,
    discount: 0,
    payment: "",
  };
  setCart({ ...cleanCart });
};

/**
 * Calcula el nuevo precio luego de aplicar una promocion
 * @function
 * @param {JSON} promotion JSON de promocion obtenido del back-end
 * @returns Nuevo valor despues de promocion
 */
export const getPromotionDiscount = (promotion) => {
  let totalOriginal = 0
  for (const prodProm of promotion.productos_promocion){
    totalOriginal += prodProm.producto.precio_actual * prodProm.cantidad
  }
  return totalOriginal - promotion.precio_promocion
}

/**
 * Calcula el total final de la venta considerando todas las promociones.
 * @function
 * @param {Cart} cart 
 * @returns {number} Valor final de venta
 */
export const getTotal = (cart) => {
  let total = cart.total
  for (const prom of cart.promotionList) {
    total -= getPromotionDiscount(prom)
  }
  return total
}
/**
 * Componente que muestra el carrito
 * @returns Renderizado de Carrito
 */
const ListCart = () => {
  const [cart, setCart] = useContext(CartContext);

  return (
    &lt;>
      &lt;Row >
        &lt;Col span={24} style={{}}>
          &lt;List
            style={{ background: "#fff" }}
            // footer={&lt;div>Sub-Total: ${cart.total}&lt;/div>}
            footer={
              &lt;Row>
                &lt;Col span={12}>
                  {
                    cart.promotionList.length > 0 ?
                    &lt;h4>Sub-Total&lt;/h4> :
                    &lt;h4>Total&lt;/h4>
                  }
                &lt;/Col>
                &lt;Col span={12}>
                  &lt;h4 style={{ float: "right" }}>${cart.total}&lt;/h4>
                &lt;/Col>
              &lt;/Row>
            }
            bordered
            dataSource={cart.productList}
            renderItem={(productObj) => (
              &lt;List.Item>
                &lt;List.Item.Meta
                  /*avatar={&lt;Avatar src="/uploads/perro_729fefb8c4.png" />}*/
                  title={productObj.productName}
                  description={
                    &lt;div>
                      {productObj.quantity} unidades a ${productObj.unitPrice}
                      /unidad{" "}
                    &lt;/div>
                  }
                />
                &lt;div>${productObj.totalPrice}&lt;/div>
              &lt;/List.Item>
            )}
          />
        &lt;/Col>
      &lt;/Row>
      {/* &lt;Divider orientation="center">Promociones&lt;/Divider> */}
      &lt;Row >
        &lt;Col span={24} style={{}}>
          { 
            cart.promotionList.length > 0 ? 
            &lt;List
              style={{ background: "#fff" }}
              // footer={&lt;div>Total: ${cart.total}&lt;/div>}
              footer={
                &lt;Row>
                  &lt;Col span={12}>&lt;h3>Total&lt;/h3>&lt;/Col>
                  &lt;Col span={12}>
                    &lt;h3 style={{ float: "right" }}>${getTotal(cart)}&lt;/h3>
                  &lt;/Col>
                &lt;/Row>
              }
              bordered
              dataSource={cart.promotionList}
              renderItem={(promotion) => (
                &lt;List.Item>
                  &lt;List.Item.Meta
                    /*avatar={&lt;Avatar src="/uploads/perro_729fefb8c4.png" />}*/
                    title={promotion.nombre}
                    description={
                      &lt;div>
                        Valor: ${promotion.precio_promocion}
                      &lt;/div>
                    }
                  />
                  &lt;div>Descuento: ${getPromotionDiscount(promotion)}&lt;/div>
                &lt;/List.Item>
              )}
            />
            : null
          }
        &lt;/Col>
      &lt;/Row>
    &lt;/>
  );
};

export default ListCart;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#clearCart">clearCart</a></li><li><a href="global.html#ConfirmSale">ConfirmSale</a></li><li><a href="global.html#createSale">createSale</a></li><li><a href="global.html#getPromotionDiscount">getPromotionDiscount</a></li><li><a href="global.html#getTotal">getTotal</a></li><li><a href="global.html#ListCart">ListCart</a></li><li><a href="global.html#ListProducts">ListProducts</a></li><li><a href="global.html#LoginForm">LoginForm</a></li><li><a href="global.html#MenuTop">MenuTop</a></li><li><a href="global.html#newSale">newSale</a></li><li><a href="global.html#Payment">Payment</a></li><li><a href="global.html#Pos">Pos</a></li><li><a href="global.html#SearchBar">SearchBar</a></li><li><a href="global.html#SelectStore">SelectStore</a></li><li><a href="global.html#Voucher">Voucher</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Mon Jul 05 2021 17:53:06 GMT-0400 (Chile Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
